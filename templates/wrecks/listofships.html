{% extends "wrecks/template.html" %}
{% block title %}
    <title>Ship List</title>
{% endblock %}
{% block styles %}
    <style>
        #content {
            background: transparent;
            position: relative;
            z-index: 1;
        }

        #content b {
            font-family: "Berkshire Swash", cursive;
            font-size: 22px;
        }

        /* Always set the map height explicitly to define the size of the div element that contains the map. */
        #table {
            height: 100%;
            width: 75%;
            margin-left: 5px;
            margin-top: 12px;
        }
    </style>
{% endblock %}

{% block content %}
    <center>
        <table id="table" class="table table-hover table-sm">
            <thead>
            <tr>
                <th><b>Ship Name</b></th>
                <th><b>Ship Number</b></th>
                <th><b>Year Sunk</b></th>
            </tr>
            </thead>
        </table>
    </center>
{% endblock %}

{% block scripts %}
    <script>
        var ships = [];
        var table = document.getElementById("table");

        function list(ship) {
            var row = table.insertRow(-1);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            //TODO: This way of adding links feels janky, find a cleaner way to do it. maybe a wrapper function or something
            cell1.innerHTML = "<a href=\"/ships/" + ship["name"] + "/" + ship["num"] + "/\">" + ship["name"] + "</a>";
            cell2.innerHTML = "<a href=\"/ships/" + ship["name"] + "/" + ship["num"] + "/\">" + ship["num"] + "</a>";
            cell3.innerHTML = "<a href=\"/ships/" + ship["name"] + "/" + ship["num"] + "/\">" + ship["year"] + "</a>";
            console.log(ship["name"] + ship["num"] + ship["year"]);
        }

        function init() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState === 4 && this.status === 200) {
                    ships = JSON.parse(this.responseText);
                    ships.forEach(list);
                }
            };
            xmlhttp.open("GET", "/wrecks/allShips.json", true);
            xmlhttp.send();
        }

        init();
    </script>
{% endblock %}